<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quản lý đơn thuê - LOCALGO</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    :root {
      --main-color: #00bfa5;
    }
    body { background-color: #f8f9fa; }
    .navbar {
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .navbar-brand {
      color: var(--main-color) !important;
      font-weight: 700;
      font-size: 1.5rem;
    }
    .order-card {
      background: #fff;
      border-radius: .75rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .order-card img {
      width: 150px;
      height: 100px;
      object-fit: cover;
      border-radius: .5rem;
    }
    .status {
      font-weight: 600;
    }
    .status.pending { color: #f59e0b; }
    .status.active { color: #00bfa5; }
    .status.completed { color: #2563eb; }
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="navbar navbar-expand-lg navbar-light sticky-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">LOCALGO</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link fw-semibold" href="listing.html">Thuê xe</a></li>
          <li class="nav-item"><a class="nav-link fw-semibold" href="upcar.html">Đăng xe</a></li>
          <li class="nav-item"><a class="nav-link fw-semibold active" href="dashboard.html">Quản lý</a></li>
          <li class="nav-item"><a class="nav-link fw-semibold" href="chat.html">Chat</a></li>
          <li class="nav-item ms-lg-3"><a href="#" class="btn btn-outline-primary btn-sm px-3">Đăng nhập</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="fw-bold mb-0">Quản lý đơn thuê</h2>
      <div>
        <button id="seedBtn" class="btn btn-success btn-sm me-2"><i class="bi bi-database-fill-add"></i> Tạo dữ liệu demo</button>
        <button id="clearBtn" class="btn btn-outline-danger btn-sm"><i class="bi bi-trash3"></i> Xóa dữ liệu</button>
      </div>
    </div>
    <p class="text-muted">Dữ liệu demo lưu ở localStorage. Làm mới trang sẽ giữ nguyên.</p>

    <div id="ordersList" class="vstack gap-3 mt-4"></div>
  </main>

  <!-- MODAL -->
  <div class="modal fade" id="orderModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Chi tiết hợp đồng thuê xe</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3 align-items-center">
            <div class="col-md-5">
              <img id="modalImg" src="" class="img-fluid rounded" alt="Xe">
            </div>
            <div class="col-md-7">
              <h4 id="modalCar"></h4>
              <p><i class="bi bi-person"></i> <span id="modalUser"></span></p>
              <p><i class="bi bi-geo-alt"></i> <span id="modalLocation"></span></p>
              <p><i class="bi bi-calendar"></i> <span id="modalDate"></span></p>
              <p><i class="bi bi-cash"></i> <span id="modalPrice" class="text-success fw-bold"></span></p>
              <p><strong>Trạng thái:</strong> <span id="modalStatus" class="status"></span></p>
            </div>
          </div>
          <hr>
          <h6>Điều khoản hợp đồng (demo):</h6>
          <ul>
            <li>Người thuê cam kết trả xe đúng giờ, nguyên vẹn.</li>
            <li>Xe không được sử dụng cho mục đích trái pháp luật.</li>
            <li>Thanh toán toàn bộ chi phí trước khi nhận xe.</li>
          </ul>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Đóng</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="bg-light py-3 mt-5 text-center text-muted small">
    © 2025 LOCALGO — Demo quản lý thuê xe ô tô.
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const listEl = document.getElementById('ordersList');
    const modal = new bootstrap.Modal('#orderModal');
    const ordersKey = 'localgo_orders';

    // Hàm render danh sách
    function renderOrders() {
      const orders = JSON.parse(localStorage.getItem(ordersKey) || '[]');
      listEl.innerHTML = orders.length ? "" : "<p class='text-muted'>Chưa có đơn thuê nào.</p>";
      orders.forEach((o, idx) => {
        const div = document.createElement('div');
        div.className = "order-card p-3 d-flex align-items-center justify-content-between";
        div.innerHTML = `
          <div class="d-flex align-items-center gap-3">
            <img src="${o.img}" alt="${o.car}">
            <div>
              <h5 class="mb-1">${o.car}</h5>
              <div class="text-muted small">${o.user} • ${o.location}</div>
              <div class="status ${o.status}">${o.status}</div>
            </div>
          </div>
          <div class="text-end">
            <div class="fw-bold text-success mb-2">${o.price.toLocaleString()}đ</div>
            <button class="btn btn-outline-primary btn-sm me-2 view-btn" data-id="${idx}">Xem</button>
            <button class="btn btn-outline-danger btn-sm del-btn" data-id="${idx}"><i class="bi bi-trash"></i></button>
          </div>
        `;
        listEl.appendChild(div);
      });
    }

    // Seed data demo
    document.getElementById('seedBtn').onclick = () => {
      const demo = [
        { car:"Toyota Vios 2022", user:"Nguyễn Văn A", location:"Hà Nội", date:"2025-10-25", price:850000, status:"pending", img:"https://cdn2.mioto.vn/m/vehicle/2022/12/06/10/BfW8C8TkR2p4F9d8t9cQoQ.jpg" },
        { car:"Kia Sedona 2021", user:"Trần Thị B", location:"TP.HCM", date:"2025-10-24", price:1200000, status:"active", img:"https://cdn2.mioto.vn/m/vehicle/2023/03/09/17/hN3q7CMfKMUdJvF5W6lHiw.jpg" },
        { car:"Mercedes E300", user:"Lê Văn C", location:"Đà Nẵng", date:"2025-10-20", price:2500000, status:"completed", img:"https://cdn2.mioto.vn/m/vehicle/2022/08/03/15/MbDplZnlOrH4Q2X5uU3q9Q.jpg" }
      ];
      localStorage.setItem(ordersKey, JSON.stringify(demo));
      renderOrders();
    };

    // Xóa dữ liệu
    document.getElementById('clearBtn').onclick = () => {
      localStorage.removeItem(ordersKey);
      renderOrders();
    };

    // Event xem + xóa
    document.addEventListener('click', e => {
      const orders = JSON.parse(localStorage.getItem(ordersKey) || '[]');
      if (e.target.classList.contains('view-btn')) {
        const id = e.target.dataset.id;
        const o = orders[id];
        document.getElementById('modalImg').src = o.img;
        document.getElementById('modalCar').textContent = o.car;
        document.getElementById('modalUser').textContent = o.user;
        document.getElementById('modalLocation').textContent = o.location;
        document.getElementById('modalDate').textContent = o.date;
        document.getElementById('modalPrice').textContent = o.price.toLocaleString() + "đ";
        document.getElementById('modalStatus').textContent = o.status;
        document.getElementById('modalStatus').className = "status " + o.status;
        modal.show();
      }
      if (e.target.classList.contains('del-btn') || e.target.closest('.del-btn')) {
        const id = e.target.dataset.id || e.target.closest('.del-btn').dataset.id;
        orders.splice(id, 1);
        localStorage.setItem(ordersKey, JSON.stringify(orders));
        renderOrders();
      }
    });

    renderOrders();
  </script>
</body>
</html>
